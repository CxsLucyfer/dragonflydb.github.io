<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta name=viewport content="width=device-width,initial-scale=1"><title>A prelude to analysis of Redis memory-store</title><meta name=author content="Dragonfly"><meta name=keywords content="dragonfly,in-memory,datastore,scale"><meta name=description content="Dragonfly - Scalable in-memory datastore made simple"><meta name=generator content="Hugo 0.99.1"><link href=https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css rel=stylesheet integrity=sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3 crossorigin=anonymous><link href=/css/style.turquoise.css rel=stylesheet id=theme-stylesheet><link rel=preload href=/scss/main.min.0810f7d37c96bc2b5be6719e4021c62aab62baf088d01858a1b7ad99aebc2b5d.css as=style><link href=/scss/main.min.0810f7d37c96bc2b5be6719e4021c62aab62baf088d01858a1b7ad99aebc2b5d.css rel=stylesheet integrity><link rel="shortcut icon" href=/img/favicon.ico type=image/x-icon><link rel=apple-touch-icon href=/img/apple-touch-icon.png><meta property="og:locale" content="en_us"><meta property="og:site_name" content="Dragonfly"><meta property="og:title" content="A prelude to analysis of Redis memory-store"><meta property="og:type" content="article"><meta property="og:url" content="https://www.dragonflydb.io/blog/2021/11/28/redis_analysis/"><meta property="og:description" content="Dragonfly - Scalable in-memory datastore made simple"><meta property="og:image" content="https://www.dragonflydb.io/img/banners/1200px-Redis_Logo.svg.png"><meta property="og:image:type" content="image/png"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="401"><meta property="og:updated_time" content="2021-11-28T17:46:19+0300"><meta property="article:section" content="Engineering"><meta property="article:published_time" content="2021-11-28T17:46:19+0300"><meta property="article:modified_time" content="2021-11-28T17:46:19+0300"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@AttosIO"><meta name=twitter:title content="A prelude to analysis of Redis memory-store"><meta name=twitter:image content="https://www.dragonflydb.io/img/banners/1200px-Redis_Logo.svg.png"><meta name=twitter:description content="Dragonfly - Scalable in-memory datastore made simple"><link rel=stylesheet href=//use.fontawesome.com/releases/v6.1.1/css/all.css><link href="//fonts.googleapis.com/css?family=Poppins:600,700,800,900" rel=stylesheet type=text/css><link href="//fonts.googleapis.com/css?family=Lato:100,300,400" rel=stylesheet type=text/css></head><body><div class=page-container><header><div id=top><div class=container><div class=row><div class=col-xs-12>Try Dragonfly in your own environment&nbsp;<a href=/get_started/ data-animate-hover=pulse> >>></a></div></div></div></div></header><nav class="navbar navbar-expand-lg navbar-light bg-light shadow-sm main-nav"><div class=container><a class=navbar-brand href=/><img src=/img/logo.svg alt="A prelude to analysis of Redis memory-store logo" class="collapse navbar-collapse"></a>
<button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=.navbar-collapse aria-controls=navbarNavAltMarkup aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse justify-content-end"><div class=navbar-nav><a class=nav-link href=/platform>Platform</a>
<a class="nav-link active" href=/blog/>Blog</a>
<a class="nav-link git" href=https://github.com/romange/dragonfly><svg width="25" height="25" viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" fill="#6069f6" style="position:relative;top:-2px"><path d="M13 2C6.9225 2 2 6.84 2 12.8093c0 4.7768 3.1515 8.8275 7.52125 10.2557C10.0712 23.1667 10.2729 22.8322 10.2729 22.5452 10.2729 22.2886 10.2638 21.6084 10.2592 20.7073 7.19933 21.3591 6.554 19.2572 6.554 19.2572 6.0535 18.0096 5.33025 17.6759 5.33025 17.6759 4.33383 17.0058 5.40725 17.0196 5.40725 17.0196 6.51183 17.0947 7.09208 18.1333 7.09208 18.1333c.98084 1.6528 2.57492 1.1752 3.20372.8993C10.3948 18.3332 10.6781 17.8574 10.9925 17.587 8.54958 17.3166 5.982 16.3871 5.982 12.2456c0-1.1798.42625-2.1441 1.13208-2.90035C6.99033 9.07208 6.61908 7.973 7.21033 6.48433c0 0 .92125-.28966 3.02497 1.10825C11.1153 7.35242 12.0503 7.23325 12.9853 7.22775 13.9203 7.23325 14.8553 7.35242 15.7353 7.59258c2.09-1.39791 3.0113-1.10825 3.0113-1.10825C19.3378 7.973 18.9666 9.07208 18.8566 9.34525c.7012.75625 1.1275 1.72055 1.1275 2.90035.0 4.1525-2.5713 5.0664-5.0188 5.3322C15.3503 17.9023 15.7078 18.5651 15.7078 19.578c0 1.4465-.0137 2.6088-.0137 2.9599C15.6941 22.8212 15.8866 23.1594 16.4503 23.0512 20.8512 21.6322 24 17.5787 24 12.8093 24 6.84 19.0748 2 13 2z"/></svg>Git</a>
<a href=/get_started/ class="btn btn-primary get-started">Get Dragonfly</a></div></div></div></nav><main><script>MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]]},svg:{fontCache:"global"}}</script><script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js></script><div id=blog-post class=pt-5><div class=container><div class="row blog_header"><div class="col-2 d-none d-lg-flex"><a href=javascript:history.back() class="btn btn-outline-dark my-auto">&lt; Back</a></div><div class=col><span class=category_label>Engineering</span><h4>A prelude to analysis of Redis memory-store</h4><h6 class="card-subtitle mb-2">November 28, 2021
By <a href=/authors/roman-gershman>Roman Gershman</a></h6></div><div class="col-2 d-none d-lg-flex"></div></div><div class=row><div class="col-2 d-none d-lg-flex"></div><div class=col><div id=post-content><p>During the last 13 years, Redis has become a truly ubiquitous memory store that has won the hearts
of numerous dev-ops and software engineers. Indeed, according to <a href=https://insights.stackoverflow.com/survey/2021#databases>StackOverflow survey in
2021</a>, Redis is the most loved database for the 5th time in a row and is at the top of
<a href=https://db-engines.com/en/ranking/key-value+store>db-engines</a> ranking, way before the next contestant.
But how well does Redis utilizes modern hardware systems?
Will it stay competitive in a few years without reinventing itself?</p><p>To understand choices behind Redis design, I have been reading <a href=http://oldblog.antirez.com/>the old posts</a> of Salvatore @antirez - the creator of Redis. Before I begin, I want to add that I have tremendous respect for Salvatore and for how much he achieved by being a talented and authentic software programmer
(even though <a href=http://antirez.com/news/133>he does not want to be remembered as such</a>).</p><p>Based on his notes and GitHub discussions, I identified the following architectural principles in Redis:</p><ol><li><p><strong>Simple is beautiful (and code is a poem)</strong><br>Probably the strongest motive around Redis is simplicity. Salvatore&rsquo;s preference is towards simple solutions and he expressed his attitude to coding in his
<a href=http://oldblog.antirez.com/post/redis-manifesto.html>Redis manifesto</a>. As a consequence,
Redis resides in a single self-contained codebase without much reliance on third-party projects and
its functionality is implemented in plain C using posix API.</p></li><li><p><strong>Single-threaded architecture</strong><br>Redis development started a few years after Memcached. By that time, Memcached, the predecessor of Redis,
has already been a mature system that has been used and supported by large, highly
technological companies like Facebook and Twitter. It used multi-threaded architecture
to scale its I/O performance vertically within a single node.
Remarkably, antirez decided against this architecture and adopted the single-threaded design instead.
Specifically, Redis utilizes a single thread that manipulates its
main in-memory dictionary. antirez has defended this approach many times with the following arguments:</p><ul><li>Redis cares very much about latency and adopts share-nothing architecture to control its tail
and average latencies.</li><li>Most of the CPU spent on system-cpu handling I/O and not on userland cpu handling Redis data-structures.
Therefore, the upside of parallelization is limited anyway.</li><li>Pipelining of requests can increase throughput by order of magnitude.</li><li>On the other hand, multi-threading adds complexity. Quoting antirez:
&ldquo;&mldr;Slower development speed to achieve the same features. Multi-thread programming is hard&mldr;
In a future of cloud computing, I want to consider every single core as a computer itself&mldr;&rdquo;</li><li>Vertical scale has physical limit anyway, therefore horizontal scaling (aka Redis cluster)
is the way to scale.</li></ul></li></ol><p>In addition to the principles above, Redis maintains unique design goals that differentiate it
from, say, a disk-based database. I believe that if we list Redis design goals by priority, it will be:</p><ol><li>Low latency</li><li>High throughput</li><li>Memory efficiency</li><li>High availability</li><li>Strong consistency guarantees</li><li>Durability</li></ol><p>Obviously, if one would want to implement an alternative memory store he would need to prioritize design goals
similarly to Redis. In other words, the new store design should not sacrifice low latency for durability,
or for strong consistency.</p><h2 id=retrospective>Retrospective</h2><p>I think that <em>simplicity</em> was the main guideline for Redis which heavily affected architectural decisions
like its serialization algorithm, efficiency of its data structures, reliability and more.
Even the choice of its threading model has been, in part, done because of simplicity reasons.
And if Redis is the experiment on how far one can go nowdays by implementing relatively simple solutions, it without
a question succeeded tremendously.</p><p>Redis in 2021 is a mature product with relatively stable feature set, and the questions I am asking myself
today are:
a) how more efficienty Redis could be today if it would adopt state-of-the-art algorithms and datastructures.
b) how much simpler it would be for a user if it adopt product simplicity over simplicity of implementation.</p><p>In other words, if one would want to implement a drop-in replacement for Redis <strong>today</strong> by
redesigning it from scratch, how it would compare to Redis. I do not have a definite answer to this question today but hope to have one in few months.</p><p>Again, I am not arguing with the tremendous popularity of the Redis memory store. It seems that Salvatore&rsquo;s
decision to go for simplicity and deliver features quickly in Redis early days - paid off: today Memcached is a niche
system, and the vast majority of software stacks use Redis. However, I do claim (currently without proof)
that it is possible to <strong>vastly</strong> improve reliability, performance and cost-efficiency metrics of Redis-like memory store that follows similar design goals but with different architectural principles.</p><p>In my next posts, I am going to detail Redis specific design choices based on the principles state above
and show how a different architecture, if aligned better with modern hardware systems, could provide, what I think
a disruptive change to in-memory datastores.</p></div></div><div class="col-2 d-none d-lg-flex"></div></div></div></div></main><footer id=copyright><div class=container><div class=row><div class=col-12><img src=/img/icon.svg></div></div><div class=row><div class=col-6><p>Copyright (c) 2021 - 2022, Attos Technologies Ltd; all rights reserved.</p><p>Template by <a href=https://bootstrapious.com/p/universal-business-e-commerce-template>Bootstrapious</a>.
Ported to Hugo by <a href=https://github.com/devcows/hugo-universal-theme>DevCows</a>.</p></div><div class=col-6><small>* Redis is a trademark of Redis Ltd. Any rights therein are reserved to Redis Ltd. Any use by Attos is for referential purposes only and does not indicate any sponsorship, endorsement or affiliation between Redis and Attos.</small></div></div></div></footer><script async src="https://www.googletagmanager.com/gtag/js?id=G-EZMGVEP6RT"></script>
<script>var dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes";if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-EZMGVEP6RT",{anonymize_ip:!1})}</script><script src=https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js integrity=sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p crossorigin=anonymous></script>
<script src=/js/dragonfly_console.js async defer></script></div></body></html>